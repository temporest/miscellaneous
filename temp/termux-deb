pkg install pulseaudio nano
nano ~/.profile
proot-distro login debian --user root --shared-tmp

apt install sudo vim firefox-esr

passwd

groupadd storage
groupadd wheel
groupadd video

useradd -m -g users -G wheel,audio,video,storage -s /bin/bash user
passwd user

visudo
find something like root ALL=(ALL:ALL) ALL. Add this in the next line of it.
user ALL=(ALL:ALL) ALL

su user
cd

apt install xfce4 xfce4-goodies dbus-x11
ln -sf /usr/share/zoneinfo/Asia/Ho_Chi_Minh /etc/localtime
apt install locales fonts-noto-cjk

nano /etc/locale.gen
Uncomment (remove “#”) your langauge.

locale-gen
echo "LANG=en_US.UTF-8" > /etc/locale.conf


- Start desktop environment (manually)
    + Relaunch Termux
    + Launch Termux X11 app, keep it opening in the background. Go back to Termux and type the following commands to run Termux X11.

pulseaudio --start --exit-idle-time=-1
pacmd load-module module-native-protocol-tcp auth-ip-acl=127.0.0.1 auth-anonymous=1

export DISPLAY=:0
termux-x11 :0 &

virgl_test_server_android &

proot-distro login debian --user user --shared-tmp


    + Start desktop environment

export DISPLAY=:0
PULSE_SERVER=tcp:127.0.0.1
dbus-launch --exit-with-session startxfce4 &

    + You shall see XFCE4 desktop showing at Termux X11. Tap floating window and revoke permission to make it go full screen.


- Start desktop environment in one-click
# use Termux Widget to start everything automatically
    + Install Termux API and Termux Widget

https://github.com/termux/termux-api/releases/download/v0.53.0/termux-api-app_v0.53.0+github.debug.apk
https://github.com/termux/termux-widget/releases/download/v0.15.0/termux-widget-app_v0.15.0+github.debug.apk

    + Go to system settings → all apps, turn on “Permit Drawing Over Other Apps” for Termux.

    + Restart Termux. Create a shortcut in Termux (not in proot-distro)

mkdir .shortcuts
nano .shortcuts/startproot_debian.sh

    + Type these

#!/bin/bash

killall -9 termux-x11 pulseaudio virgl_test_server_android termux-wake-lock

termux-toast "Starting X11"
am start --user 0 -n com.termux.x11/com.termux.x11.MainActivity
XDG_RUNTIME_DIR=${TMPDIR}
termux-x11 :0 -ac &
sleep 3

pulseaudio --start --exit-idle-time=-1
pacmd load-module module-native-protocol-tcp auth-ip-acl=127.0.0.1 auth-anonymous=1

virgl_test_server_android &

proot-distro login debian --user user --shared-tmp -- bash -c "export DISPLAY=:0 PULSE_SERVER=tcp:127.0.0.1; dbus-launch --exit-with-session startxfce4"

    + Make it executable.

chmod +x .shortcuts/startproot_debian.sh

    + Go to your home screen, long press and add widgets → select “Termux Widget”. You would see the shortcut we made is on the list.

    + Click “startproot_debian.sh” then the XFCE desktop would start automatically.

    + Swipe down the notification bar, click Preferences of Termux X11. Then you can switch touch screen mode to simulating touchpad.

        + If the fonts are too small in Termux X11, click Settings Manager at top-left → Appearance and change font size or select 2x window scaling.

        + To stop the XFCE session, press CTRL+C in Termux. Then logout of proot Debian.

exit
